{% extends 'main/index.html' %}

{% block name_list %}Book{% endblock %}
{% block create_link %}{% url 'libraries:book_create' %}{% endblock %}
{% block model_name %}book{% endblock %}

{% block filter_inputs %}
    <div class="input-group mb-3">
        <div class="input-group-append">
            <select class="form-select" id="filterField" onchange="filterBooks()">
                <option value="title">Title</option>
                <option value="gender__name">Gender</option>
                <option value="status__name">Status</option>
            </select>
        </div>
        <input type="text" class="form-control" id="filterValue" placeholder="Enter filter value" oninput="filterBooks()">
    </div>
{% endblock %}

{% block table_headers %}
    <th>Title</th>
    <th>Gender</th>
    <th>Quantity</th>
    <th>Author</th>
    <th>Library</th>
    <th>Status</th>
{% endblock %}

{% block table_fields %}
    <td>{{ item.title }}</td>
    <td>{{ item.gender }}</td>
    <td>{{ item.quantity }}</td>
    <td>{{ item.author }}</td>
    <td>{{ item.library }}</td>
    <td>{{ item.status }}</td>
{% endblock %}

{% block detail_link %}{% url 'libraries:book_detail' item.id %}{% endblock %}
{% block edit_link %}{% url 'libraries:book_update' item.id %}{% endblock %}

{% block no_list %}books{% endblock %}

{% block extra_scripts %}
    <script>
        function filterBooks() {
            var filterValue = $("#filterValue").val().toLowerCase();
            var filterField = $("#filterField").val();

            var libraryId = {{ library_id|default:"null" }};

            var url = libraryId ? "/libraries/library/" + libraryId + "/book/" : 
                                    "/libraries/book/";

            $.ajax({
                url: url,
                type: "GET",
                data: {
                    filter_value: filterValue,
                    filter_field: filterField
                },
                success: function (data) {
                    $('#model-table tbody').html(data.html);
                }
            });
        }
    </script>
{% endblock %}